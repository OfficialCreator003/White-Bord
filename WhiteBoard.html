<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Professional Whiteboard App</title>

<style>
:root{
  --bg:#f3f4f6;
  --panel:#ffffff;
  --primary:#111827;
  --accent:#2563eb;
}
*{box-sizing:border-box;font-family:Segoe UI,Arial}
body{margin:0;background:var(--bg)}
header{
  background:var(--primary);
  color:white;
  padding:12px;
  text-align:center;
}
.container{
  padding:12px;
  display:grid;
  grid-template-columns:2fr 1fr;
  gap:12px;
}
.toolbar{
  grid-column:1/3;
  background:var(--panel);
  padding:8px;
  display:flex;
  flex-wrap:wrap;
  gap:6px;
  border-radius:8px;
}
button{
  border:none;
  background:#e5e7eb;
  padding:6px 10px;
  border-radius:6px;
  cursor:pointer;
}
button.active{background:var(--accent);color:white}
canvas{
  width:100%;
  height:420px;
  background:white;
  border-radius:8px;
  border:2px solid #ccc;
}
.editor{
  background:var(--panel);
  border-radius:8px;
  padding:10px;
  display:flex;
  flex-direction:column;
}
textarea{
  flex:1;
  resize:none;
  padding:10px;
  border-radius:6px;
}
.footer{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-top:6px;
  font-size:12px;
}
.hidden{display:none}
</style>
</head>

<body>

<header>
<h2>ğŸ§  Professional Whiteboard & Notes</h2>
</header>

<div class="container">

<div class="toolbar">
  <button data-tool="pen" class="active">âœ Pen</button>
  <button data-tool="eraser">ğŸ§½ Eraser</button>
  <button data-tool="line">ğŸ“ Line</button>
  <button data-tool="rect">â–­ Rect</button>
  <button data-tool="circle">âšª Circle</button>

  ğŸ¨ <input type="color" id="color" value="#000000">
  ğŸ–Œ <input type="range" id="size" min="1" max="20" value="5">

  <button id="undo">â†¶</button>
  <button id="redo">â†·</button>
  <button id="clear">ğŸ—‘</button>
  <button id="save">ğŸ’¾</button>
</div>

<canvas id="canvas"></canvas>

<div class="editor">
  <h3>ğŸ“ Notes</h3>
  <textarea id="notes"></textarea>
  <div class="footer">
    <span id="count">0 words</span>
    <button id="download">â¬‡ Download</button>
  </div>
</div>

</div>

<script>
/* ================= STATE ================= */
const state = {
  tool: "pen",
  color: "#000000",
  size: 5,
  drawing: false,
  startX: 0,
  startY: 0,
  history: [],
  redo: []
};

/* ================= CANVAS ================= */
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

function resizeCanvas(){
  const img = ctx.getImageData(0,0,canvas.width,canvas.height);
  canvas.width = canvas.offsetWidth;
  canvas.height = canvas.offsetHeight;
  ctx.putImageData(img,0,0);
}
window.addEventListener("resize", resizeCanvas);
resizeCanvas();

/* ================= HISTORY ================= */
function saveHistory(){
  state.history.push(ctx.getImageData(0,0,canvas.width,canvas.height));
  if(state.history.length > 30) state.history.shift();
  state.redo = [];
}
saveHistory();

/* ================= TOOL SELECT ================= */
document.querySelectorAll("[data-tool]").forEach(btn=>{
  btn.onclick=()=>{
    document.querySelectorAll("[data-tool]").forEach(b=>b.classList.remove("active"));
    btn.classList.add("active");
    state.tool = btn.dataset.tool;
  };
});

color.oninput = e => state.color = e.target.value;
size.oninput = e => state.size = e.target.value;

/* ================= DRAW ================= */
canvas.onmousedown = e=>{
  state.drawing = true;
  state.startX = e.offsetX;
  state.startY = e.offsetY;
  ctx.beginPath();
  ctx.moveTo(state.startX,state.startY);
  saveHistory();
};

canvas.onmousemove = e=>{
  if(!state.drawing) return;

  ctx.lineWidth = state.size;
  ctx.lineCap = "round";

  if(state.tool === "eraser"){
    ctx.globalCompositeOperation = "destination-out";
    ctx.strokeStyle = "rgba(0,0,0,1)";
  }else{
    ctx.globalCompositeOperation = "source-over";
    ctx.strokeStyle = state.color;
  }

  if(state.tool === "pen" || state.tool === "eraser"){
    ctx.lineTo(e.offsetX,e.offsetY);
    ctx.stroke();
  }
};

canvas.onmouseup = e=>{
  if(!state.drawing) return;
  state.drawing = false;
  ctx.globalCompositeOperation = "source-over";

  if(["line","rect","circle"].includes(state.tool)){
    const x = e.offsetX - state.startX;
    const y = e.offsetY - state.startY;
    ctx.strokeStyle = state.color;

    if(state.tool === "line"){
      ctx.beginPath();
      ctx.moveTo(state.startX,state.startY);
      ctx.lineTo(e.offsetX,e.offsetY);
      ctx.stroke();
    }
    if(state.tool === "rect"){
      ctx.strokeRect(state.startX,state.startY,x,y);
    }
    if(state.tool === "circle"){
      const r = Math.hypot(x,y);
      ctx.beginPath();
      ctx.arc(state.startX,state.startY,r,0,Math.PI*2);
      ctx.stroke();
    }
  }
};

/* ================= UNDO / REDO ================= */
undo.onclick = ()=>{
  if(state.history.length > 1){
    state.redo.push(state.history.pop());
    ctx.putImageData(state.history.at(-1),0,0);
  }
};

redo.onclick = ()=>{
  if(state.redo.length){
    const img = state.redo.pop();
    state.history.push(img);
    ctx.putImageData(img,0,0);
  }
};

/* ================= ACTIONS ================= */
clear.onclick = ()=>{
  if(confirm("Clear canvas?")){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    saveHistory();
  }
};

save.onclick = ()=>{
  const a=document.createElement("a");
  a.download="whiteboard.png";
  a.href=canvas.toDataURL();
  a.click();
};

/* ================= NOTES ================= */
const notes=document.getElementById("notes");
notes.value=localStorage.getItem("notes")||"";
notes.oninput=()=>{
  localStorage.setItem("notes",notes.value);
  count.textContent =
    notes.value.trim().split(/\s+/).filter(Boolean).length + " words";
};
notes.oninput();

download.onclick=()=>{
  const blob=new Blob([notes.value],{type:"text/plain"});
  const a=document.createElement("a");
  a.download="notes.txt";
  a.href=URL.createObjectURL(blob);
  a.click();
};
</script>

</body>
</html>
